!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("node:events")):"function"==typeof define&&define.amd?define(["exports","node:events"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self)["nwjs-window-manager"]={},n.require$$0)}(this,(function(n,e){"use strict";function t(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}function o(n,e,t,o){return new(t||(t=Promise))((function(i,a){function r(n){try{c(o.next(n))}catch(n){a(n)}}function l(n){try{c(o.throw(n))}catch(n){a(n)}}function c(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(r,l)}c((o=o.apply(n,e||[])).next())}))}const i=t(e).default;function a(n){return new Promise((e=>{"complete"===n.readyState||"interactive"===n.readyState?e():n.addEventListener("DOMContentLoaded",(()=>e()))}))}let r,l="";const c={};let s=Date.now();function d(n,e={},t=(()=>{})){return new Promise((o=>{"function"==typeof e&&(t=e,e={});const{name:i="wm_"+ ++s,parent:a,modal:r}=e,l=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(n);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(n,o[i])&&(t[o[i]]=n[o[i]])}return t}(e,["name","parent","modal"]),{position:d,always_on_top:f}=e;if(c[i]){const n=c[i];return n.focus(),t(n),o(n)}const p=!1!==l.show;l.show=!1,nw.Window.open(n,l,(n=>{if(!n)return;const e=y(n,{name:i,parent:a,modal:r,position:d,always_on_top:f});p&&e.show(),t(e),o(e)}))}))}function f(n){return n?"string"==typeof n?c[n]:"nwWin"in n?n:"cWindow"in n?p().find((e=>e.nwWin.window===n.window)):void 0:y(nw.Window.get())}function p(n){const e=Object.values(c);return n&&n(e),e}function u(n){return!!n.find((n=>n.modalParent))}function w(n){return!!n.find((n=>n.modal||w(n.children)))}function m(n){return n.alwaysOnTop||n.parent&&m(n.parent)||!1}function y(n,e={}){if(!n)return;const t=f(n);if(t){const{parent:p,modal:h}=e;return p&&(t.parent=y(p)),void 0!==h&&t.parent&&(t.parent.modal=h),t}if("object"==typeof n&&"cWindow"in n){const g=n,O=new i;let v,b=e.name||"wm_"+ ++s,j=e.modal||!1,x=!1,T=!1,P=!1,W=!1,_=[];function E(n){v=n,v.children.push(C),j&&!v.modal&&(v.modal=!0)}function z(){if(v){const n=v.children.indexOf(C);n>=0&&(v.children.splice(n,1),u(v.children)||(v.modal=!1)),v=void 0}}const M=g.setAlwaysOnTop,A=g.close,S=g.on,$=[],C=Object.assign(g,{nwWin:g,name:b,modalParent:j,modal:x,alwaysOnTop:T,isMinimize:P,isMaximize:W,children:_,parent:void 0,open:(n,e,t)=>("function"==typeof e&&(t=e,e={}),d(n,Object.assign({parent:C},e),t)),setAlwaysOnTop(n){n?(T=!0,M.call(C,!0),_.forEach((n=>n.alwaysOnTop=!0))):m(C)||(T=!1,M.call(C,!1))},close(n){(n||!x&&!w(_))&&(z(),delete c[b],A.call(C,!0),_.forEach((n=>n.close(!0))))},on:(n,e)=>("close"===n?$.push(e):S.call(C,n,e),C),$on:(n,e)=>(O.on(n,e),C),$off:(n,e)=>(O.off(n,e),C),$emit:(n,...e)=>(O.emit.call(O,n,...e),C)});return Object.defineProperties(C,{nwWin:{get:()=>g},name:{get:()=>b},alwaysOnTop:{get:()=>T,set(n){this.setAlwaysOnTop(n)}},isMinimize:{get:()=>P},isMaximize:{get:()=>W},modalParent:{get:()=>j,set(n){n!==j&&v&&(n?v.modal||(v.modal=!0,j=!0):u(v.children)||(v.modal=!1,j=!1))}},modal:{get:()=>x,set(n){n!==x&&(n?(!function(n){o(this,void 0,void 0,(function*(){const e=n.window.document;yield a(e);const t=e.createElement("style");t.id="nwjs-window-manager-style",t.innerHTML=`html, body {\n  overflow: hidden !important;\n}\n.nwjs-window-manager-modal {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.95);\n  z-index: 10000;\n}\n${l}`,e.head.appendChild(t);const o=e.createElement("div");o.classList.add("nwjs-window-manager-modal"),e.body.appendChild(o)}))}(C),x=!0):u(_)||(!function(n){o(this,void 0,void 0,(function*(){const e=n.window.document;yield a(e),e.querySelectorAll("#nwjs-window-manager-style,.nwjs-window-manager-modal").forEach((n=>n.remove()))}))}(C),x=!1))}},children:{get:()=>_},parent:{get:()=>v,set(n){if(n){const e=y(n);e&&e!==v&&(z(),E(e))}else z()}}}),e.parent&&(C.parent=y(e.parent)),(e.always_on_top||m(C))&&(C.alwaysOnTop=!0),C.parent&&"parentCenter"===e.position&&(C.x=C.parent.x+(C.parent.width-C.width)/2,C.y=C.parent.y+(C.parent.height-C.height)/2),c[b]=C,C.on("focus",(()=>{let n;_.forEach((e=>{e.isMinimize||(e.focus(),n=e)})),n&&r&&r(n)})),S.call(C,"close",(()=>{$.length>0?$.forEach((n=>n())):x||w(_)||C.close(!0)})),C.on("minimize",(()=>{x||j?C.restore():P=!0})),C.on("maximize",(()=>{x?C.restore():W=!0})),C.on("restore",(()=>{P=!1,W=!1})),C}}const h=Object.assign(y,{open:d,get:f,getAll:p,config:function(n){"string"==typeof n.modalStyle&&(l=n.modalStyle),"function"==typeof n.onAutoFocusTailWindow&&(r=n.onAutoFocusTailWindow)}});n.wm=h,Object.defineProperty(n,"__esModule",{value:!0})}));
